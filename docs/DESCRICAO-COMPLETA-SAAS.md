# MoncoyFinance - Descrição Completa do SaaS

## 📊 Visão Geral

**MoncoyFinance** é uma plataforma SaaS completa de gestão financeira pessoal para o mercado brasileiro, com inteligência artificial integrada, sistema de assinaturas multi-tier e autenticação social. A plataforma oferece controle completo das finanças pessoais, análises preditivas e insights personalizados através de IA generativa.

**Site:** https://moncoyfinance.com  
**Versão:** 0.1.0  
**Status:** Em Produção  
**Modelo de Negócio:** Freemium com planos Basic, Professional e Premium

---

## 🎯 Problema Resolvido

Brasileiros enfrentam dificuldades para:
- Controlar gastos e receitas mensais
- Planejar metas financeiras de longo prazo
- Entender padrões de consumo
- Gerenciar investimentos e compromissos financeiros
- Obter insights personalizados sobre suas finanças

**MoncoyFinance** resolve esses problemas oferecendo uma plataforma intuitiva, inteligente e acessível, com análises de IA que aprendem os hábitos financeiros do usuário.

---

## 🚀 Funcionalidades Principais

### 1. **Gestão Financeira Completa**

#### Transações Inteligentes
- ✅ Registro de receitas e despesas com categorização automática
- ✅ Transações recorrentes (diárias, semanais, mensais, anuais)
- ✅ Status automático: pendente, concluído, atrasado, vencendo em breve
- ✅ Priorização (baixa, média, alta)
- ✅ Métodos de pagamento múltiplos
- ✅ Notas e anexos para contexto adicional

#### Categorias Personalizáveis
- ✅ Categorias customizáveis por tipo (receita/despesa)
- ✅ Sistema de cores para identificação visual
- ✅ Categorias padrão + criação de categorias próprias

#### Orçamento e Metas
- ✅ Definição de metas financeiras com prazos
- ✅ Acompanhamento de progresso em tempo real
- ✅ Alertas de orçamento e metas próximas do objetivo
- ✅ Priorização de metas

### 2. **Investimentos e Patrimônio**

#### Portfólio de Investimentos
- ✅ Cadastro de ativos: ações, FIIs, ETFs, renda fixa, criptomoedas, fundos
- ✅ Histórico de compra/venda com preço médio automático
- ✅ Integração com corretoras (via cadastro manual)
- ✅ Cálculo de rentabilidade e desempenho

#### Análise de Portfólio
- ✅ Diversificação por tipo de ativo
- ✅ Gráficos de evolução patrimonial
- ✅ Comparação de performance

### 3. **Agenda Financeira**

#### Calendário de Compromissos
- ✅ Visualização em calendário mensal/semanal/diário
- ✅ Tipos: receita, despesa, investimento, reunião, outros
- ✅ Compromissos recorrentes
- ✅ Notificações de lembrete

### 4. **Inteligência Artificial Generativa**

#### IA Adaptativa com Período de Aprendizado
- ✅ **Plano Basic**: Período de aprendizado de 22 dias antes de liberar IA
- ✅ **Planos Pro/Premium**: Acesso imediato à IA

#### Análises Disponíveis
- ✅ Análise de padrões de gastos
- ✅ Sugestões de economia personalizadas
- ✅ Alertas de orçamento proativos
- ✅ Previsões de saldo futuro
- ✅ Recomendações de investimento
- ✅ Análise de comprometimento de renda

#### Modelos de IA por Plano
- **Basic**: GPT-4o-mini (5 perguntas/semana após 22 dias)
- **Professional**: GPT-4o-mini (7 perguntas/semana)
- **Premium**: GPT-4o (50 perguntas/mês)

#### Sistema de Controle de Uso
- ✅ Contador de perguntas server-side no banco de dados
- ✅ Sincronização entre dispositivos
- ✅ Reset automático semanal (Basic/Pro) ou mensal (Premium)
- ✅ Display de perguntas restantes na interface
- ✅ Analytics de uso para administração

### 5. **Relatórios e Insights**

#### Dashboards Interativos
- ✅ Resumo financeiro mensal
- ✅ Gráficos de receitas vs. despesas
- ✅ Análise de categorias mais gastadas
- ✅ Projeções de saldo
- ✅ Indicadores de saúde financeira

#### Relatórios Exportáveis
- ✅ Relatórios mensais em PDF (planos Pro/Premium)
- ✅ Extrato de transações por período
- ✅ Relatório de metas e progresso
- ✅ Consolidado de investimentos

### 6. **Notificações Inteligentes**

- ✅ Alertas de vencimento de contas
- ✅ Notificações de metas próximas ao objetivo
- ✅ Avisos de orçamento estourado
- ✅ Lembretes de transações recorrentes
- ✅ Insights de IA (quando disponíveis)

### 7. **Sistema de Suporte**

#### Suporte Multi-canal
- ✅ Chat ao vivo (planos Pro/Premium)
- ✅ Email support (todos os planos)
- ✅ WhatsApp Business (planos Pro/Premium)
- ✅ Base de conhecimento
- ✅ Sistema de tickets com priorização

#### Portal do Cliente
- ✅ Histórico de tickets
- ✅ FAQ interativo
- ✅ Tutoriais em vídeo
- ✅ Horário comercial expandido para Premium

---

## 💰 Planos e Preços

### 🆓 Plano Basic - R$ 19,90/mês

**Funcionalidades:**
- ✅ Gestão completa de transações
- ✅ Categorias ilimitadas
- ✅ Metas financeiras
- ✅ Investimentos básicos
- ✅ Agenda financeira
- ⏳ **IA após 22 dias de uso** (período de aprendizado)
- 📊 5 perguntas de IA por semana (após liberação)
- 📄 Relatórios simples
- 📧 Suporte por email

**Ideal para:** Usuários iniciando no controle financeiro

---

### 💼 Plano Professional - R$ 49,90/mês

**Tudo do Basic +**
- ✅ **IA liberada imediatamente** (sem período de espera)
- 📊 7 perguntas de IA por semana (1 por dia)
- 📈 Análises detalhadas
- 📄 Relatórios em PDF
- 💾 Histórico de conversas com IA
- 🔔 Alertas de gastos avançados
- 📱 Acesso mobile prioritário
- 📧💬 Suporte email + WhatsApp

**Ideal para:** Profissionais que buscam controle avançado

---

### 👑 Plano Premium - R$ 59,90/mês

**Tudo do Professional +**
- ✅ **IA GPT-4o** (modelo mais avançado)
- 📊 50 perguntas de IA por mês
- 🔬 Análises avançadas e preditivas
- 📊 Relatórios executivos completos
- 🎯 Consultoria financeira via IA
- 📈 Previsões de mercado
- 🏆 Suporte prioritário 24/7
- 💬 Chat ao vivo
- 📞 Atendimento telefônico

**Ideal para:** Investidores e gestores de patrimônio

---

## 🏗️ Arquitetura Técnica

### Stack Tecnológico

#### Frontend
- **Framework**: Next.js 15.5.2 (App Router + React 19)
- **UI Library**: Radix UI + shadcn/ui
- **Styling**: Tailwind CSS 4.1.9 + Tailwind Animate
- **Fontes**: Geist Sans/Mono (Vercel)
- **Ícones**: Lucide React
- **Gráficos**: Recharts + React Big Calendar
- **Forms**: React Hook Form + Zod validation
- **State**: React Context API

#### Backend & Infraestrutura
- **Database**: Supabase (PostgreSQL)
- **Authentication**: Supabase Auth + Google OAuth
- **Storage**: Supabase Storage (fotos de perfil)
- **API**: Next.js API Routes + Server Actions
- **AI**: OpenAI API (GPT-4o / GPT-4o-mini)
- **Payments**: Stripe Checkout + Billing Portal
- **Deployment**: Docker + Standalone build
- **Analytics**: Vercel Speed Insights

#### Segurança
- **Row Level Security (RLS)**: Políticas no Supabase
- **Server-side rendering**: Proteção de dados sensíveis
- **HTTPS**: Obrigatório em produção
- **CORS**: Configurado para domínio próprio
- **Cookies**: Secure + SameSite

### Padrões de Arquitetura

#### Client/Server Boundary
```typescript
// Server Components (padrão em app/)
async function Page() {
  const supabase = await createClient() // Server-side
  const { data } = await supabase.from('transactions').select()
  return <Dashboard data={data} />
}

// Client Components (com "use client")
'use client'
function TransactionForm() {
  const supabase = supabase // Client singleton
  // ...
}

// Server Actions (com "use server")
'use server'
async function createTransaction(formData: FormData) {
  const supabase = await createClient() // Sempre await!
  // ...
}
```

#### Camada de API Centralizada
```typescript
// @/lib/api.ts - Single source of truth
export const userApi = {
  getCurrentUser: () => Promise<User>,
  updateUser: (data) => Promise<User>,
  createUserProfile: () => Promise<void>,
}

export const transactionsApi = { /* ... */ }
export const goalsApi = { /* ... */ }
export const investmentsApi = { /* ... */ }
```

#### Fluxo de Autenticação
1. Login via email/senha ou Google OAuth
2. Criação automática de perfil em `public.users`
3. Verificação de role (user/admin via `ADMIN_EMAILS`)
4. Proteção de rotas via Guards: `UserGuard`, `AdminGuard`, `PublicGuard`
5. Session persistente com cookies HttpOnly

### Banco de Dados

#### Tabelas Principais
- `users` - Perfis de usuários + planos
- `transactions` - Receitas/despesas + recorrências
- `categories` - Categorias personalizáveis
- `goals` - Metas financeiras
- `investments` - Portfólio de investimentos
- `investment_transactions` - Histórico de compra/venda
- `recurring_transactions` - Template de recorrências
- `commitments` - Agenda financeira
- `budgets` - Orçamentos por categoria
- `ai_insights` - Insights gerados pela IA
- `ai_usage` - Controle de uso de IA (server-side)
- `notifications` - Sistema de notificações
- `support_tickets` - Tickets de suporte
- `user_settings` - Preferências do usuário

#### RLS Policies
- Usuários acessam apenas seus próprios dados
- Admins têm acesso global (via `auth.jwt() ->> 'email'`)
- Políticas separadas para SELECT, INSERT, UPDATE, DELETE

---

## 🔐 Segurança e Compliance

### Autenticação e Autorização
- ✅ OAuth 2.0 com Google
- ✅ Session-based auth com cookies seguros
- ✅ Password hashing (Supabase Auth)
- ✅ Email verification obrigatória
- ✅ Password reset seguro via token

### Privacidade (LGPD)
- ✅ Consentimento de cookies
- ✅ Política de privacidade completa
- ✅ Termos de uso detalhados
- ✅ Configurações de privacidade por usuário
- ✅ Opt-out de notificações
- ✅ Direito ao esquecimento (via suporte)

### Proteção de Dados
- ✅ Dados criptografados em trânsito (TLS 1.3)
- ✅ Backup automático diário (Supabase)
- ✅ Row Level Security no banco
- ✅ API keys em variáveis de ambiente
- ✅ Rate limiting em APIs críticas

---

## 📊 Métricas e Analytics

### KPIs Disponíveis para Admin
- Total de usuários ativos
- Distribuição de planos (Basic/Pro/Premium)
- Taxa de conversão (trial → pago)
- Uso de IA por plano
- Tickets de suporte por prioridade
- Churn rate mensal
- MRR (Monthly Recurring Revenue)

### Métricas para Usuários
- Gastos mensais por categoria
- Evolução patrimonial
- Taxa de cumprimento de metas
- Score de saúde financeira
- Comparativo mês a mês

---

## 🎨 Design e UX

### Design System
- **Componentes**: shadcn/ui (headless + customizável)
- **Cores**: Sistema de design tokens via CSS variables
- **Temas**: Dark mode + Light mode automático
- **Responsividade**: Mobile-first (Tailwind breakpoints)
- **Acessibilidade**: ARIA labels + navegação por teclado

### Fluxos Principais

#### 1. Onboarding
```
Cadastro → Email Verification → Login → Criação de Perfil → 
Tutorial Interativo → Primeira Transação → Dashboard
```

#### 2. Upgrade de Plano
```
Dashboard → Ver Limitações → Modal de Upgrade → 
Stripe Checkout → Callback de Sucesso → Atualização de Plano
```

#### 3. Uso de IA (Plano Basic)
```
Registro → 22 dias de uso → Countdown na UI → 
Liberação da IA → 5 perguntas/semana → Reset semanal
```

---

## 🚢 Deploy e DevOps

### Ambiente de Produção

#### Docker
```dockerfile
# Multi-stage build com standalone output
FROM node:22-slim AS base
# ... install dependencies
FROM base AS builder
# ... build with STANDALONE=true
FROM gcr.io/distroless/nodejs22-debian12 AS runner
# ... copy standalone output
EXPOSE 3000
CMD ["server.js"]
```

#### Variáveis de Ambiente Necessárias
```env
# Supabase
NEXT_PUBLIC_SUPABASE_URL=https://xxx.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJxxx...
SUPABASE_SERVICE_ROLE_KEY=eyJxxx...

# Stripe
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_live_xxx
STRIPE_SECRET_KEY=sk_live_xxx
STRIPE_WEBHOOK_SECRET=whsec_xxx

# OpenAI
OPENAI_API_KEY=sk-proj-xxx

# App
NEXT_PUBLIC_SITE_URL=https://moncoyfinance.com
NODE_ENV=production
STANDALONE=true
```

### CI/CD
- Build automático via Docker
- Deploy manual ou via GitHub Actions (futuro)
- Health checks na porta 3000
- Rollback automático em caso de erro

---

## 📈 Roadmap Futuro

### Q1 2026
- [ ] App mobile nativo (React Native)
- [ ] Integração com Open Banking
- [ ] Importação automática de extratos bancários
- [ ] Modo colaborativo (finanças familiares)

### Q2 2026
- [ ] Marketplace de templates de orçamento
- [ ] Gamificação (badges, níveis, desafios)
- [ ] Comunidade de usuários (fórum)
- [ ] API pública para integrações

### Q3 2026
- [ ] Consultoria financeira ao vivo (Premium)
- [ ] Cursos de educação financeira
- [ ] Sistema de afiliados
- [ ] Versão White Label para empresas

---

## 🐛 Issues Conhecidos

### TypeScript
- ❌ 20 erros TypeScript remanescentes (tipos faltantes)
- ❌ Button variant "success" não existe (usar "default")
- ❌ Propriedades faltantes em `Goal` e `SupportSettings`

### Performance
- ⚠️ Dashboard faz múltiplas queries independentes (não otimizado)
- ⚠️ 86+ console.logs em produção (migrar para logger)

### Admin
- ⚠️ Emails admin hardcoded (mover para env vars)

---

## 📚 Documentação Adicional

### Documentos Relacionados
- `ALTERACOES-REALIZADAS.md` - Changelog completo
- `ANALISE-CODIGO.md` - Análise técnica detalhada
- `GOOGLE_AUTH_CUSTOMIZATION.md` - Setup OAuth Google
- `README-PRODUCTION.md` - Guia de produção
- `AI-USAGE-MIGRATION.md` - Migração do sistema de IA

### Links Úteis
- [Supabase Dashboard](https://app.supabase.com)
- [Stripe Dashboard](https://dashboard.stripe.com)
- [OpenAI Usage](https://platform.openai.com/usage)
- [Vercel Analytics](https://vercel.com/analytics)

---

## 🤝 Suporte e Contato

### Para Usuários
- **Email**: suporte@moncoyfinance.com
- **WhatsApp**: +55 11 9xxxx-xxxx (Pro/Premium)
- **Chat**: Disponível no app (Pro/Premium)

### Para Desenvolvedores
- **Repositório**: GitHub (privado)
- **Issues**: GitHub Issues
- **Docs**: `/docs` no repositório

---

## 📄 Licença

**Proprietary Software**  
© 2025 MoncoyFinance. Todos os direitos reservados.

---

**Última atualização:** 24 de outubro de 2025  
**Versão do documento:** 1.0  
**Autor:** Sistema de Documentação MoncoyFinance
